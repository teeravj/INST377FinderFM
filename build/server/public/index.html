<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="author" content="">

  <title>FM Filters</title> 

</head>

<body>
  <div class="container">
      <div class="wrapper">
        <div class="header">PG County Farmers Markets</div>
        <!-- <button class="button" onclick="loadData()">Load Some JSON</button> -->
        sun: <input type="checkbox" id="sun" class="day">
        mon: <input type="checkbox" id="mon" class="day">
        tues: <input type="checkbox" id="tues" class="day">
        wed: <input type="checkbox" id="wed" class="day">
        thurs: <input type="checkbox" id="thurs" class="day">
        fri: <input type="checkbox" id="fri" class="day"> 
        sat: <input type="checkbox" id="sat" class="day">
        <input type="submit" value="Submit" id="submit" onclick="fetchData()">
        <div class="content">
          <ul class="results"></ul>
        </div>
        <div class="footer"></div>
      </div>
    </div>
    <script>
      
      function fetchData() {
        console.log('fetch'); // make sure onClick works accordingly
        fetch('/api')
          .then(res => res.json())
          .then(res => {
            console.log(res); // make sure res is what we think
            return res;
          })
          /* this calls the fmarray object by its key (fmarray) so we can access 
          the array in the object that we created in line 54 in the server.js file*/
          .then(res => res.fmarray)
          .then(data => data.map(f => f.market_name))
          // this calls the function that inserts the array into the html as an unordered list
          .then(markets => makeListInHTML(markets)); 
        };

      function makeListInHTML(array) {
        const htmlTarget = document.querySelector('.content');
        htmlTarget.innerHTML = '';
        let el1 = document.createElement("ul");
        el1.className = 'list';
        htmlTarget.appendChild(el1);

        for (let i = 0; i < array.length; i++) {
          let el = document.createElement("li");
          el.innerText = array[i];
          htmlTarget.appendChild(el);
          };
        }
    </script>
</body>